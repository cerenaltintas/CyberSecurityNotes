TCP protokolÃ¼ Ã¼zerinde Ã§alÄ±ÅŸan servisler aÄŸ gÃ¼venliÄŸi ve penetrasyon testleri sÄ±rasÄ±nda sÄ±kÃ§a incelenir. Ancak, TCP'nin yanÄ± sÄ±ra, belirli bir RFC'deki (RFC 793) boÅŸluktan yararlanarak aÃ§Ä±k ve kapalÄ± portlarÄ± tespit etmeyi mÃ¼mkÃ¼n kÄ±lan Ã¶zel tarama teknikleri de vardÄ±r: TCP FIN, NULL ve Xmas taramalarÄ±.

### TCP FIN, NULL ve Xmas TaramalarÄ±nÄ±n Temelleri

Bu Ã¼Ã§ tarama yÃ¶ntemi, TCP RFC'sinde belirtilen bir davranÄ±ÅŸa dayanÄ±r: EÄŸer hedef port kapalÄ±ysa ve gelen segment **RST** iÃ§ermiyorsa, yanÄ±t olarak bir **RST** paketi gÃ¶nderilir. AÃ§Ä±k portlara yÃ¶nelik paketlerde ise **SYN**, **RST** veya **ACK** bitleri ayarlanmadÄ±ÄŸÄ±nda, bu paketlerin dÃ¼ÅŸÃ¼rÃ¼lmesi ve herhangi bir yanÄ±t gÃ¶nderilmemesi gerektiÄŸi belirtilir.

### FIN TaramasÄ± (-sF)

Bu tarama yÃ¶ntemi, TCP FIN paketlerini hedef sistemlere gÃ¶nderir. AÃ§Ä±k portlar bu paketleri gÃ¶rmezden gelirken, kapalÄ± portlar ICMP port unreachable mesajÄ±yla yanÄ±t verir.

![](https://storage.hackviser.com/file/hackviser-prod/trainings/sections/images/ea047221-bad0-4fe5-81ae-c3de38656e45/image-3-4ccf5a7b6.webp)

```auto
rootğŸ’€hackerbox:~# nmap -sF scanme.nmap.org
Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-30 14:58 +03
Nmap scan report for scanme.nmap.org (45.33.32.156)
Host is up (0.25s latency).
All 1000 scanned ports on scanme.nmap.org (45.33.32.156) are in ignored states.
Not shown: 1000 open|filtered tcp ports (no-response)

Nmap done: 1 IP address (1 host up) scanned in 62.71 seconds
```

### NULL TaramasÄ± (-sN)

NULL taramasÄ±, TCP baÅŸlÄ±ÄŸÄ±nda herhangi bir bayraÄŸÄ±n ayarlanmadÄ±ÄŸÄ± paketler gÃ¶nderir. AÃ§Ä±k portlar herhangi bir yanÄ±t vermezken, kapalÄ± olanlar ICMP port unreachable mesajÄ± gÃ¶nderir.

![](https://storage.hackviser.com/file/hackviser-prod/trainings/sections/images/ea047221-bad0-4fe5-81ae-c3de38656e45/image-5-5bd187bda.webp)

```auto
rootğŸ’€hackerbox:~# nmap -sN scanme.nmap.org
Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-30 15:01 +03
Host is up (0.29s latency).
All 1000 scanned ports on scanme.nmap.org (45.33.32.156) are in ignored states.
Not shown: 1000 open|filtered tcp ports (no-response)

Nmap done: 1 IP address (1 host up) scanned in 62.87 seconds
```

### Xmas TaramasÄ± (-sX)

Xmas taramasÄ±, PSH, FIN ve URG TCP bayraklarÄ±nÄ±n ayarlandÄ±ÄŸÄ± paketler gÃ¶ndererek Ã§alÄ±ÅŸÄ±r. KapalÄ± portlar ICMP port unreachable mesajÄ± ile yanÄ±t verir, aÃ§Ä±k portlardan ise genellikle bir yanÄ±t alÄ±namaz.

![](https://storage.hackviser.com/file/hackviser-prod/trainings/sections/images/ea047221-bad0-4fe5-81ae-c3de38656e45/image-4-dbefd3a10.webp)

```auto
rootğŸ’€hackerbox:~# nmap -sX scanme.nmap.org
Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-30 15:03 +03
Nmap scan report for scanme.nmap.org (45.33.32.156)
Host is up (0.25s latency).
All 1000 scanned ports on scanme.nmap.org (45.33.32.156) are in ignored states.
Not shown: 1000 open|filtered tcp ports (no-response)

Nmap done: 1 IP address (1 host up) scanned in 62.97 seconds
```

### Tarama YÃ¶ntemlerinin KullanÄ±mÄ± ve DavranÄ±ÅŸÄ±

Bu tarama yÃ¶ntemlerinin kullanÄ±mÄ± basittir ve davranÄ±ÅŸlarÄ±, gÃ¶nderilen istek paketlerindeki TCP bayraklarÄ± dÄ±ÅŸÄ±nda, aslÄ±nda aynÄ±dÄ±r. YanÄ±tlar, aÅŸaÄŸÄ±daki gibi deÄŸerlendirilir:

- **AÃ§Ä±k|FiltrelenmiÅŸ:**Â Herhangi bir yanÄ±t alÄ±namazsa (yeniden iletimlerden sonra bile),
- **KapalÄ±:**Â TCP RST paketi alÄ±nÄ±rsa,
- **FiltrelenmiÅŸ:**Â ICMP ulaÅŸÄ±lamaz hata mesajlarÄ± alÄ±nÄ±rsa.

### Avantajlar ve Dezavantajlar

**Avantajlar:** Bu tarama tÃ¼rleri, durum bilgisi olmayan bazÄ± gÃ¼venlik duvarlarÄ±ndan ve routerlardan kaÃ§Ä±nabilecek ÅŸekilde tasarlanmÄ±ÅŸtÄ±r. AyrÄ±ca, SYN taramasÄ±ndan da gizli olduÄŸunu sÃ¶yleyebiliriz.

**Dezavantajlar:** TÃ¼m sistemler RFC 793'e tam olarak uymaz. BazÄ± sistemler, port aÃ§Ä±k olsa dahi, bu tÃ¼r taramalara RST yanÄ±tlarÄ± gÃ¶nderebilir, bu da tÃ¼m portlarÄ±n kapalÄ± olarak etiketlenmesine neden olabilir. Bu tarama Ã§oÄŸunlukla Unix tabanlÄ± sistemlerde iÅŸe yarar.