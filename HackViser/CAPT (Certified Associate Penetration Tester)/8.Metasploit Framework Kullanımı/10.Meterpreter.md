Meterpreter, hedef sistem üzerinde gelişmiş etkileşim sağlayan, RAM'de çalışan bir payload türüdür. Standart shell erişiminden çok daha fazlasını sunar; dosya sistemi manipülasyonu, sistemde bilgi toplama ve ağ etkileşimleri gibi işlemleri gerçekleştirebilir. Meterpreter, tamamen bellekte çalıştığı için disk üzerinde iz bırakmaz ve bu da güvenlik araçları tarafından yakalanmasını zorlaştırır.

Meterpreter, bellek içi DLL enjeksiyon stager'larını kullanan ve çalışma zamanında ağ üzerinden genişletilebilen gelişmiş, dinamik olarak genişletilebilir bir payload'dır. Stager soketi üzerinden iletişim kurar ve kapsamlı bir istemci tarafı Ruby API'si sunar.

### Meterpreter Nasıl Çalışır?

- Hedef, ilk olarak stager'ı çalıştırır. Bu genellikle bind, reverse, findtag, passivex vb. olur.
- Stager, DLL'i yükler. Reflective stub, DLL'in yüklenmesini/enjekte edilmesini yönetir.
- Meterpreter çekirdeği başlatılır, soket üzerinden bir TLS/1.0 bağlantısı kurar ve bir GET gönderir. Metasploit, bu GET'i alır ve istemciyi yapılandırır.
- Son olarak, Meterpreter extension'ları yükler. Genellikle stdapi'yi yükler ve modül yönetici hakları veriyorsa priv'i de yükler. Tüm bu uzantılar, bir TLV protokolü kullanılarak TLS/1.0 üzerinden yüklenir.

### Meterpreter Tasarım Hedefleri

Gizlilik

- Meterpreter tamamen bellekte bulunur ve diske hiçbir şey yazmaz.
- Yeni süreçler oluşturulmaz; Meterpreter, tehlikeye atılan sürece enjekte edilir ve diğer çalışan süreçlere kolayca geçiş yapabilir.
- Varsayılan olarak, Meterpreter şifreli iletişim kullanır.
- Bunların tümü, hedef makinede çok sınırlı iz bırakır.

Güçlü

- Meterpreter, kanallaştırılmış bir iletişim sistemini kullanır.
- TLV protokolünün çok az sınırlaması vardır.

Genişletilebilir

- Özellikler çalışma zamanında artırılabilir ve ağ üzerinden yüklenir.
- Meterpreter'a yeni özellikler eklemek basittir.

### Meterpreter Komutları

Meterpreter oturumu açmayı başardığımızda hedef sistem üzerinde çalıştırabileceğimiz gelişmiş komutlar otomatik olarak yüklenir ve kullanımımıza sunulur. Meterpreter oturumunda çalıştırabileceğimiz komutlar yüklediğimiz sisteme göre(Android, Windows, Linux vb.) değişiklik gösterebilir.

**NOT: Aşağıda bulunan komutlar listesi, Linux sistemde açılan bir meterpreter oturumunda çalıştırılabilir komutları barındırır. Android gibi farklı işletim sistemlerinde apk dosyası yükleme ya da çalıştırma gibi farklı komutlar da bulunur.**

help

Çalıştırabileceğimiz komutların listesini almak için

help

komutunu çalıştırabiliriz.

![](https://storage.hackviser.com/file/hackviser-prod/trainings/sections/images/12f1e503-f9cf-4ef8-9453-59b4b1f03445/image-9-7f2438e36.webp)

Temel Komutlar

```auto
Command                   Description
-------                   -----------
?                         Help menu
background                Backgrounds the current session
bg                        Alias for background
bgkill                    Kills a background meterpreter script
bglist                    Lists running background scripts
bgrun                     Executes a meterpreter script as a background thread
channel                   Displays information or control active channels
close                     Closes a channel
detach                    Detach the meterpreter session (for http/https)
disable_unicode_encoding  Disables encoding of unicode strings
enable_unicode_encoding   Enables encoding of unicode strings
exit                      Terminate the meterpreter session
guid                      Get the session GUID
help                      Help menu
info                      Displays information about a Post module
irb                       Open an interactive Ruby shell on the current session
load                      Load one or more meterpreter extensions
machine_id                Get the MSF ID of the machine attached to the session
pry                       Open the Pry debugger on the current session
quit                      Terminate the meterpreter session
read                      Reads data from a channel
resource                  Run the commands stored in a file
run                       Executes a meterpreter script or Post module
secure                    (Re)Negotiate TLV packet encryption on the session
sessions                  Quickly switch to another session
use                       Deprecated alias for "load"
uuid                      Get the UUID for the current session
write                     Writes data to a channel
```

Dosya Sistemi Komutları

```auto
Command                   Description
-------                   -----------
cat                       Read the contents of a file to the screen
cd                        Change directory
checksum                  Retrieve the checksum of a file
chmod                     Change the permissions of a file
cp                        Copy source to destination
del                       Delete the specified file
dir                       List files (alias for ls)
download                  Download a file or directory
edit                      Edit a file
getlwd                    Print local working directory
getwd                     Print working directory
lcat                      Read the contents of a local file to the screen
lcd                       Change local working directory
lls                       List local files
lmkdir                    Create new directory on local machine
lpwd                      Print local working directory
ls                        List files
mkdir                     Make directory
mv                        Move source to destination
pwd                       Print working directory
rm                        Delete the specified file
rmdir                     Remove directory
search                    Search for files
upload                    Upload a file or directory
```

Ağ Komutları

```auto
Command                   Description
-------                   -----------
arp                       Display the host ARP cache
getproxy                  Display the current proxy configuration
ifconfig                  Display interfaces
ipconfig                  Display interfaces
netstat                   Display the network connections
portfwd                   Forward a local port to a remote service
resolve                   Resolve a set of host names on the target
route                     View and modify the routing table
```

Sistem Komutları

```auto
Command                   Description
-------                   -----------
execute                   Execute a command
getenv                    Get one or more environment variable values
getpid                    Get the current process identifier
getuid                    Get the user that the server is running as
kill                      Terminate a process
localtime                 Displays the target system local date and time
pgrep                     Filter processes by name
pkill                     Terminate processes by name
ps                        List running processes
shell                     Drop into a system command shell
suspend                   Suspends or resumes a list of processes
sysinfo                   Gets information about the remote system, such as OS
```

Webcam Komutları

```auto
Command                   Description
-------                   -----------
webcam_chat               Start a video chat
webcam_list               List webcams
webcam_snap               Take a snapshot from the specified webcam
webcam_stream             Play a video stream from the specified webcam
```

Mikrofon Komutları

```auto
Command                   Description
-------                   -----------
listen                    listen to a saved audio recording via audio player
mic_list                  list all microphone interfaces
mic_start                 start capturing an audio stream from the target mic
mic_stop                  stop capturing audio
```

Ses Çıkış Komutları

```auto
Command                   Description
-------                   -----------
play                      play a waveform audio file (.wav) on the target system
```