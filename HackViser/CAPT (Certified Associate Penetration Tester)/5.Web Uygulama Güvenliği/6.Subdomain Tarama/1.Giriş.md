Subdomain tarama, bir web sitesine sızma testi uygulama sürecinin önemli bir parçasıdır. Bu yöntem, bir ana domain altında yer alan ve genellikle ana web sitesinin farklı bölümlerine, hizmetlerine veya uygulamalarına hizmet eden alt alan adlarını (subdomain) keşfetmeyi amaçlar. Subdomain tarama ile sızma testi uzmanları, potansiyel güvenlik açıklarını, bilgi sızıntılarını ve yönetim paneli gibi hassas noktaları belirleyebilir.

Subdomain taraması yapmak için çeşitli araçlar ve teknikler mevcuttur. Bu yöntemler arasında:

**Brute Force Tarama:** En yaygın kullanılan yöntemlerden biri, wordlistler kullanarak hedef domain için olası subdomain adlarını denemektir.

**DNS Sorgulama:** DNS kayıtlarını sorgulayarak veya DNS zone transfer denemeleri yaparak mevcut subdomainlerin bir listesi elde edilebilir.

**Arama Motorları:** Google, Bing gibi arama motorlarını kullanarak hedef domain ile ilişkili subdomainleri bulmak.

**Üçüncü Parti Araçlar ve Servisler:** Shodan, Censys veya VirusTotal gibi üçüncü parti araçlar ve servisler, subdomain keşfi için faydalı bilgiler sağlayabilir.

### Subdomain

Subdomain, bir domainin altında yer alan ve genellikle ana sitenin farklı bir bölümüne veya bir alt projeye hizmet eden bir alan adıdır. Temel olarak, subdomain.domain.com formatında ifade edilir. Örneğin, blog.example.com bir subdomaintir ve genellikle ana site olan example.com'dan farklı içerik veya hizmetler sunar.

Subdomain Kullanım Alanları

**İçerik Ayırma:** Farklı içerik türlerini veya hizmetleri ayırmak için, örneğin

blog.example.com

,

support.example.com

.

**Çoklu Dil Desteği:** Farklı dillerdeki versiyonlar için, örneğin

en.example.com

,

es.example.com

.

**Uygulama Ayrımı:** Farklı uygulama ve hizmetler için, örneğin

app.example.com

,

api.example.com

.

### Vhost

Vhost veya Sanal Host, tek bir fiziksel sunucu üzerinde birden fazla web sitesinin barındırılmasını sağlayan bir tekniktir. Sanal hosting, aynı sunucu kaynaklarını kullanarak farklı domain adlarını (web sitelerini) ağırlayabilir. Bu, özellikle web hosting sağlayıcıları için maliyet etkin bir çözümdür.

Vhost Kullanım Alanları

**Maliyet Etkinliği:** Birden fazla siteyi aynı sunucu üzerinde barındırarak maliyetleri düşürme.

**Yönetim Kolaylığı:** Tek bir sunucu üzerinden birden fazla siteyi yönetme ve bakım yapma kolaylığı.

**Kaynak Paylaşımı:** CPU, bellek ve depolama gibi kaynakların birden fazla site arasında paylaşılması.

### Subdomain vs Vhost

Subdomain ve Vhost, web sitelerini ve uygulamalarını yönetmek için kullanılan farklı tekniklerdir, ancak her ikisi de benzersiz avantajlar sunar.

**Yapısal Fark:** Subdomain, ana domainin bir alt bölümü olarak işlev görürken, Vhost, bir sunucunun aynı kaynakları kullanarak birden fazla siteye hizmet vermesini sağlar.

**Kullanım Amacı:** Subdomainler genellikle içerik, dil veya hizmet ayrımı için kullanılırken, Vhost teknolojisi çoklu site barındırma ihtiyacından doğmuştur.

**Yönetim:** Subdomain yönetimi, DNS ayarları üzerinden yapılırken, Vhost ayarları web sunucusunun konfigürasyon dosyalarında yapılır.

**Not:** Aynı web sunucusunda hem domain servis edilebilir hem de vhost olarak subdomainler servis edilebilir.

**Örnek Apache Vhost Konfigürasyonu**

Aşağıdaki örnekte

example.com

ve

api.example.com

subdomaini vhost olarak aynı sunucuda sunulmaktadır.

```auto
<VirtualHost *:80>
    ServerName example.com
    DocumentRoot "/www/example"
</VirtualHost>

<VirtualHost *:80>
    ServerName api.example.com
    DocumentRoot "/www/api_example"
</VirtualHost>
```

**Örnek Nginx Vhost Konfigürasyonu**

Aşağıdaki örnekte

example.com

ve

api.example.com

subdomaini vhost olarak aynı sunucuda sunulmaktadır.

```auto
server {
    listen 80;
    server_name example.com;

    location / {
        root /www/example;
        index index.html index.htm;
    }
}

server {
    listen 80;
    server_name api.example.com;

    location / {
        root /www/api_example;
        index index.html index.htm;
    }
}
```

### Pasif Subdomain Enumeration

Pasif Subdomain Enumeration, hedefe herhangi bir ağ trafiği göndermeden veya hedef sistem üzerinde doğrudan sorgulamalar yapmadan subdomainleri keşfetme yöntemidir. Bu yöntem, çeşitli kaynaklardan zaten mevcut olan bilgileri toplar.

Kullanılan Yöntemler ve Araçlar

**Arama Motoru Dorkları:** Google, Bing gibi arama motorları, site: ve inurl: gibi operatörler kullanılarak subdomainleri keşfetmek için taranabilir.

**DNS Kayıtları:** Önceden yapılmış DNS sorgularının kayıtlarını içeren public veritabanları ve servisler.

**Üçüncü Parti Veritabanları ve Araçlar:** VirusTotal, crt.sh (SSL/TLS sertifikaları için), Shodan gibi servisler subdomain bilgilerini içerebilir.

Avantajları

- Hedef sisteme herhangi bir yük veya trafiğin neden olmaması.
- Hızlı bir şekilde geniş bilgi toplama imkanı.

### Aktif Subdomain Enumeration

Aktif Subdomain Enumeration, hedef domainin altında bulunan subdomainleri keşfetmek için doğrudan sorgulamalar yaparak çalışır. Bu yöntem, DNS sunucularına sorgular göndermek, hedef domain üzerinde brute-force denemeleri yapmak gibi daha agresif teknikleri içerir.

Kullanılan Yöntemler ve Araçlar

**DNS Brute-Force:** Wordlistler kullanılarak hedef domain için olası subdomain adları denenebilir.

**DNS Zone Transfer:** DNS Zone Transfer açıklığı olan bir DNS sunucusundan tüm DNS kayıtlarının çekilmesi.

**DNS Rekürsif Sorgulama:** Hedef domainin yetkili DNS sunucularına rekürsif sorgular gönderilerek subdomainlerin keşfedilmesi.

Avantajlar

- Pasif yöntemlerle bulunamayan daha fazla ve gizli kalmış subdomainlerin keşfedilmesi.
- Güncel ve doğrudan hedef sistemden alınan bilgilerin elde edilmesi.

### Wordlist

Web sitelerinde subdomain taraması yapmak için yaygın olarak kullanılan kelimelerden oluşan wordlistleri kullanırız. Bu yöntem, parola sözlük saldırılarına (dictionary attack) benzer bir yaklaşımdır. Bu listeler, özellikle rastgele karakterlerden oluşan veya benzersiz isimlere sahip subdomainleri bulma konusunda başararısız olsa da, genellikle bir websitenin subdomainlerinin büyük bir çoğunluğunu ortaya çıkarabilir.

Wordlistleri sıfırdan kendimiz oluşturmak yerine, bu konuda yayınlanmış kapsamlı wordlistlerden yararlanabiliriz. Web'de yapılan araştırmalar sayesinde, her türlü fuzzing işlemi için en sık kullanılan kelimeler belirlenmiş ve bu bilgiler kolayca erişilebilir hale getirilmiştir. Bu türden en popüler kelime listeleri, GitHub'daki [SecLists](https://github.com/danielmiessler/SecLists) deposunda toplanmıştır. Bu depo, fuzzing'in çeşitli türlerine göre düzenlenmiş kelime listelerini barındırır.

HackerBox'ta, SecLists deposunun tamamına

/root/Desktop/misc/SecLists

yolu üzerinden erişebiliriz. Bu depo içerisinde, subdomain tarama işlemleri için kullanabileceğimiz bir çok liste bulunuyor.

### Araçlar

Subdomain taraması için kullanılabilecek bir çok etkili araç vardır. Kısaca bu araçlara değinelim.

gobuster

Gobuster, Go dili ile yazılmış bir tarama aracıdır. Gobuster, kullanışlı bir komut satırı uygulaması olarak sunulur.

Gobuster brute-force saldırıları uygulamak için kullanılan bir araçtır:

- Websitlerindeki URI'ler (dizinler ve sayfalar),
- DNS alt alan adları (wildcard desteği vardır),
- Hedef web sunucularındaki sanal bilgisayar adları(vhost),
- Açık Amazon S3 bucket'larını,
- Açık Google Cloud bucket'larını,
- TFTP sunucularını

tespit etmek için kullanılabilir.

**Çalışma Modları**

dir

- Klasik dizin kaba kuvvet modu. Web sitelerinde belirli dizinleri ve dosyaları hızlı bir şekilde keşfetmek için kullanılır.

dns

- DNS alt alanları üzerinde kaba kuvvet modu. Hedeflenen bir alan adı için potansiyel alt alanları belirlemeye yarar.

s3

- Açık S3 bucket'larını enumerate etme ve varlıkları, bucket'ları kontrol etme modu.

gcs

- Açık Google Cloud bucket'larını enumerate etme modu.

vhost

- Sanal bilgisayar adları üzerinde brute-force modu. DNS brute-forcing’inden farklı bir yaklaşım sergiler.

fuzz

- Bazı temel fuzzing işlemleri için kullanılır. FUZZ anahtar kelimesi ile belirli bir yerde tarama yapılabilir.

tftp

- TFTP dosyaları üzerinde kaba kuvvet işlemleri yapma modu.

**Syntax**

```auto
gobuster [mode][options]
```

ffuf

FFUF (Fuzz Faster U Fool), fuzzing işlemini otomatize eden bir araçtır. Siber güvenlik uzmanlarının web uygulamalarındaki zafiyetleri bulmaları için tasarlanmıştır. FFUF, golang dili kullanılarak geliştirilmiş, açık kaynaklı ve ücretsiz bir araçtır.

FFUF, çeşitli payloadlar içeren büyük miktarda istek göndererek tarama işlemi gerçekleştirir. Daha sonra gelen yanıtları analiz eder ve hangi yöntemlerin işe yaradığını, hangilerinin yaramadığını bize bildirir.

FFUF aynı zamanda hızlı ve esnektir, fuzzing için kullanılacak girdileri ve hedef web uygulamasına gönderilen isteklerin parametrelerini belirlememize olanak tanır.

Uygulama alanları:

- Dizin keşfi,
- Vhost keşfi,
- Get parametrelerine fuzzing uygulanması,
- Post verilerine fuzzing uygulanması,

**Subdomain Keşfi**

```auto
ffuf  -u http://FUZZ.target.com/ -w <wordlist>
```

**Vhost Fuzzing**

```auto
ffuf  -u http://target.com/ -w <wordlist> -H 'Host: FUZZ.target.com'```

```