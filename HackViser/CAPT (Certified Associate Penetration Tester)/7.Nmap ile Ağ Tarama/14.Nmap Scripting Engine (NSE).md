Nmap Scripting Engine (NSE), Nmap'in en gÃ¼Ã§lÃ¼ Ã¶zelliklerinden biridir. KullanÄ±cÄ±larÄ±n, Ã§eÅŸitli aÄŸ gÃ¶revlerini otomatikleÅŸtirmek iÃ§in basit scriptler yazmasÄ±na ve paylaÅŸmasÄ±na olanak tanÄ±r. KullanÄ±cÄ±lar, Nmap ile daÄŸÄ±tÄ±lan geniÅŸ ve Ã§eÅŸitli script setini kullanabilir veya Ã¶zel ihtiyaÃ§larÄ±nÄ± karÅŸÄ±lamak iÃ§in kendi scriptlerini yazabilir.

### NSE ile YapÄ±labilecekler

- **AÄŸ KeÅŸfi:** Nmap'in ana iÅŸlevlerinden biridir. Ã–rneÄŸin, hedef domaine gÃ¶re whois verileri sorgulamak, ARIN, RIPE veya APNIC'e hedef IP'yi sorgulayarak sahipliÄŸini belirlemek, aÃ§Ä±k portlarda identd sorgulamalarÄ± yapmak, SNMP sorgularÄ± gerÃ§ekleÅŸtirmek, NFS/SMB/RPC paylaÅŸÄ±mlarÄ±nÄ± ve servislerini listelemek gibi iÅŸlemler yapÄ±labilir.
    
- **GeliÅŸmiÅŸ Versiyon Tespiti:** BazÄ± servisler, tanÄ±nmak iÃ§in iki baÄŸÄ±msÄ±z sorgu gerektirir ki bu, geleneksel Nmap versiyon tespiti ile mÃ¼mkÃ¼n deÄŸildir. Ancak NSE ile bu tÃ¼r gÃ¶revler kolaylÄ±kla gerÃ§ekleÅŸtirilebilir.
    
- **Zafiyet Tespiti:** Yeni bir zafiyet keÅŸfedildiÄŸinde, aÄŸlarÄ±nÄ±zÄ± olasÄ± saldÄ±rÄ±lardan Ã¶nce hÄ±zlÄ± bir ÅŸekilde tarayarak zafiyete aÃ§Ä±k sistemleri belirlemek istersiniz. NSE scriptleri, zafiyet kontrolÃ¼ yapmak iÃ§in kullanÄ±labilir.
    
- **Backdoor Tespiti:** BazÄ± saldÄ±rganlar veya otomatik solucanlar, sonradan yeniden giriÅŸ yapabilmek iÃ§in arka kapÄ±lar bÄ±rakÄ±r. NSE, daha karmaÅŸÄ±k solucanlarÄ± ve arka kapÄ±larÄ± gÃ¼venilir ÅŸekilde tespit etmek iÃ§in geliÅŸmiÅŸ yetenekler sunar.
    
- **Zafiyet SÃ¶mÃ¼rÃ¼sÃ¼:** Genel bir scripting dili olarak NSE, zafiyetleri bulmanÄ±n yanÄ± sÄ±ra sÃ¶mÃ¼rmek iÃ§in de kullanÄ±labilir.
    

### Script Kategorileri

auth

**TanÄ±m:** Bu kategori, hedef sistemdeki kimlik doÄŸrulama bilgileriyle (veya bunlarÄ±n aÅŸÄ±lmasÄ±yla) ilgilenir.

**Ã–rnekler:** x11-access, ftp-anon, oracle-enum-users.

**KullanÄ±m Senaryosu:** Bir sistemde anonim FTP eriÅŸiminin olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek istediÄŸinizde ftp-anon scriptini kullanabilirsiniz.

broadcast

**TanÄ±m:** Yerel aÄŸda yayÄ±n yaparak komut satÄ±rÄ±nda listelenmeyen ana bilgisayarlarÄ±n keÅŸfini gerÃ§ekleÅŸtirir.

**Ã–rnekler:** dns-sd, nbns-queries.

**KullanÄ±m Senaryosu:** Yerel aÄŸÄ±nÄ±zdaki tÃ¼m SMB sunucularÄ±nÄ± keÅŸfetmek iÃ§in kullanabilirsiniz.

brute

**TanÄ±m:** Uzak bir sunucunun kimlik doÄŸrulama kimlik bilgilerini tahmin etmek iÃ§in brute-force saldÄ±rÄ±larÄ± kullanÄ±r.

**Ã–rnekler:** http-brute, oracle-brute, snmp-brute.

**KullanÄ±m Senaryosu:** Bir web uygulamasÄ±nÄ±n zayÄ±f parolalarla korunup korunmadÄ±ÄŸÄ±nÄ± test etmek iÃ§in http-brute scriptini kullanabilirsiniz.

default

**TanÄ±m:** -sC veya -A seÃ§enekleri kullanÄ±ldÄ±ÄŸÄ±nda Ã§alÄ±ÅŸtÄ±rÄ±lan varsayÄ±lan betik setidir.

**Ã–rnekler:** identd-owners, http-auth, ftp-anon.

**KullanÄ±m Senaryosu:** Hedeflerinizdeki servisler hakkÄ±nda temel bilgileri toplamak iÃ§in varsayÄ±lan scriptleri kullanabilirsiniz.

discovery

**TanÄ±m:** AÄŸdaki daha fazla bilgiyi aktif olarak keÅŸfetmeye Ã§alÄ±ÅŸÄ±r.

**Ã–rnekler:** html-title, smb-enum-shares, snmp-sysdescr.

**KullanÄ±m Senaryosu:** Bir web sunucusunun HTML baÅŸlÄ±ÄŸÄ±nÄ± almak istediÄŸinizde html-title betiÄŸini kullanabilirsiniz.

dos

**TanÄ±m:** Hizmet reddi (Denial of Service - DoS) testleri yapabilir.

**Ã–rnekler:** http-slowloris.

**KullanÄ±m Senaryosu:** Bir web sunucusunun Slowloris saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±z olup olmadÄ±ÄŸÄ±nÄ± test etmek iÃ§in kullanabilirsiniz.

exploit

**TanÄ±m:** Aktif olarak bazÄ± zafiyetleri sÃ¶mÃ¼rmeye Ã§alÄ±ÅŸÄ±r.

**Ã–rnekler:** jdwp-exec, http-shellshock.

**KullanÄ±m Senaryosu:** Shellshock zafiyetini test etmek iÃ§in http-shellshock scriptini kullanabilirsiniz.

external

**TanÄ±m:** Verileri Ã¼Ã§Ã¼ncÃ¼ taraf bir veritabanÄ±na veya baÅŸka bir aÄŸ kaynaÄŸÄ±na gÃ¶nderebilir.

**Ã–rnekler:** whois-ip.

**KullanÄ±m Senaryosu:** Hedefinizin IP adresine iliÅŸkin whois bilgilerini almak iÃ§in whois-ip scriptini kullanabilirsiniz.

fuzzer

**TanÄ±m:** Sunucu yazÄ±lÄ±mÄ±na beklenmedik veya rastgele veriler gÃ¶ndererek yazÄ±lÄ±mdaki bulunmamÄ±ÅŸ hatalarÄ± veya zafiyetleri bulmaya Ã§alÄ±ÅŸÄ±r.

**Ã–rnekler:** dns-fuzz.

**KullanÄ±m Senaryosu:** Bir DNS sunucusunun dayanÄ±klÄ±lÄ±ÄŸÄ±nÄ± test etmek iÃ§in dns-fuzz scriptini kullanabilirsiniz.

intrusive

**TanÄ±m:** Hedef sistemde Ã§Ã¶kme riski taÅŸÄ±yan, Ã¶nemli kaynaklar kullanabilecek veya hedefin sistem yÃ¶neticileri tarafÄ±ndan kÃ¶tÃ¼ niyetli olarak algÄ±lanabilecek betiklerdir.

**Ã–rnekler:** http-open-proxy, snmp-brute.

**KullanÄ±m Senaryosu:** Bir aÄŸ Ã¼zerindeki aÃ§Ä±k HTTP proxy'leri tespit etmek iÃ§in http-open-proxy scriptini kullanabilirsiniz.

malware

**TanÄ±m:** Hedef platformun malware veya arka kapÄ±lar tarafÄ±ndan enfekte edilip edilmediÄŸini test eder.

**Ã–rnekler:** smtp-strangeport, auth-spoof.

**KullanÄ±m Senaryosu:** Bir sistemin enfekte olup olmadÄ±ÄŸÄ±nÄ± kontrol etmek iÃ§in auth-spoof scriptini kullanabilirsiniz.

safe

**TanÄ±m:** Hizmetleri Ã§Ã¶kertmek, aÄŸ bant geniÅŸliÄŸini veya diÄŸer kaynaklarÄ± bÃ¼yÃ¼k miktarda kullanmak veya gÃ¼venlik deliklerinden faydalanmak iÃ§in tasarlanmamÄ±ÅŸ betikler.

**Ã–rnekler:** ssh-hostkey, html-title.

**KullanÄ±m Senaryosu:** Bir SSH sunucusunun anahtarÄ±nÄ± almak iÃ§in ssh-hostkey scriptini kullanabilirsiniz.

version

**TanÄ±m:** Versiyon tespit Ã¶zelliÄŸinin bir uzantÄ±sÄ± olan Ã¶zel bir kategoridir ve aÃ§Ä±kÃ§a seÃ§ilemez.

**Ã–rnekler:** skypev2-version, pptp-version.

**KullanÄ±m Senaryosu:** Belirli servislerin versiyonlarÄ±nÄ± tespit etmek iÃ§in bu kategori altÄ±ndaki scriptler otomatik olarak Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r.

vuln

**TanÄ±m:** Bilinen zafiyetleri kontrol eder ve sonuÃ§larÄ± raporlar.

**Ã–rnekler:** realvnc-auth-bypass, afp-path-vuln.

**KullanÄ±m Senaryosu:** Bir sistemdeki zafiyetleri kontrol etmek iÃ§in realvnc-auth-bypass scriptini kullanabilirsiniz.

Script GeliÅŸtirme

NSE scriptleri, Lua programlama dilinde yazÄ±lmaktadÄ±r. KullanÄ±cÄ±lar, Ã¶zel ihtiyaÃ§larÄ±nÄ± karÅŸÄ±lamak iÃ§in kendi scriptlerini yazabilirler.

### Uygulama

NSE scriptlerini kullanmak son derece kolaydÄ±r. YaygÄ±n scriptleri etkinleÅŸtirmek iÃ§in

-sC

parametresini belirtmeniz yeterlidir. Ya da

--script

parametresi ile belirli scriptleri veya script kategorilerini Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã¶zel bir set belirleyebilirsiniz. BazÄ± scriptleri Ã¶zelleÅŸtirmek iÃ§in

--script-args

ve

--script-args-file

seÃ§enekleri ile argÃ¼manlar saÄŸlayabilirsiniz.

YaygÄ±n Scriptleri Tarama

```auto
rootğŸ’€hackerbox:~# nmap -sC scanme.nmap.org
Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-31 00:46 +03
Nmap scan report for scanme.nmap.org (45.33.32.156)
Host is up (0.24s latency).
Not shown: 996 filtered tcp ports (no-response)
PORT      STATE SERVICE
22/tcp    open  ssh
| ssh-hostkey: 
|   1024 ac:00:a0:1a:82:ff:cc:55:99:dc:67:2b:34:97:6b:75 (DSA)
|   2048 20:3d:2d:44:62:2a:b0:5a:9d:b5:b3:05:14:c2:a6:b2 (RSA)
|   256 96:02:bb:5e:57:54:1c:4e:45:2f:56:4c:4a:24:b2:57 (ECDSA)
|_  256 33:fa:91:0f:e0:e1:7b:1f:6d:05:a2:b0:f1:54:41:56 (ED25519)
80/tcp    open  http
|_http-title: Go ahead and ScanMe!
|_http-favicon: Nmap Project
9929/tcp  open  nping-echo
31337/tcp open  Elite

Nmap done: 1 IP address (1 host up) scanned in 133.66 seconds
```

Bu komut, varsayÄ±lan setteki scriptleri kullanarak script taramasÄ± yapar.

Belirli Script Kategorisiyle Tarama

```auto
rootğŸ’€hackerbox:~# nmap --script=vuln scanme.nmap.org
Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-31 00:49 +03
```

Bu komut, vuln kategorisindeki scriptleri Ã§alÄ±ÅŸtÄ±rarak hedef adres Ã¼zerinde bilinen zafiyetleri tarar.